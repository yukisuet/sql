<?xml version="1.0" encoding="UTF-8"?><sqlb_project><db path="farmersmarket.db" readonly="0" foreign_keys="1" case_sensitive_like="0" temp_store="0" wal_autocheckpoint="1000" synchronous="2"/><attached/><window><main_tabs open="structure browser pragmas query" current="3"/></window><tab_structure><column_width id="0" width="300"/><column_width id="1" width="0"/><column_width id="2" width="100"/><column_width id="3" width="7306"/><column_width id="4" width="0"/><expanded_item id="0" parent="1"/><expanded_item id="1" parent="1"/><expanded_item id="2" parent="1"/><expanded_item id="3" parent="1"/><expanded_item id="4" parent="1"/></tab_structure><tab_browse><table title="customer_purchases" custom_title="0" dock_id="1" table="4,18:maincustomer_purchases"/><dock_state state="000000ff00000000fd0000000100000002000003cb0000033ffc0100000001fb000000160064006f0063006b00420072006f00770073006500310100000000000003cb0000012000ffffff000002d90000000000000004000000040000000800000008fc00000000"/><default_encoding codec=""/><browse_table_settings><table schema="main" name="booth" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort><column index="2" mode="1"/></sort><column_widths><column index="1" value="104"/><column index="2" value="125"/><column index="3" value="300"/><column index="4" value="83"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="customer" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort/><column_widths><column index="1" value="89"/><column index="2" value="147"/><column index="3" value="145"/><column index="4" value="158"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="customer_purchases" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort><column index="5" mode="0"/></sort><column_widths><column index="1" value="80"/><column index="2" value="73"/><column index="3" value="91"/><column index="4" value="91"/><column index="5" value="62"/><column index="6" value="184"/><column index="7" value="119"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="product" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort><column index="4" mode="0"/></sort><column_widths><column index="1" value="80"/><column index="2" value="206"/><column index="3" value="93"/><column index="4" value="145"/><column index="5" value="124"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="vendor" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort/><column_widths><column index="1" value="73"/><column index="2" value="170"/><column index="3" value="157"/><column index="4" value="178"/><column index="5" value="175"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="vendor_booth_assignments" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort/><column_widths><column index="1" value="74"/><column index="2" value="106"/><column index="3" value="92"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table></browse_table_settings></tab_browse><tab_sql><sql name="SQL 1*">
--
--select * from customer;

SELECT  *
FROM customer
order by customer_last_name,customer_first_name
limit 10;

SELECT *
FROM customer_purchases
WHERE product_id IN (4, 9);


select *, (quantity*cost_to_customer_per_qty) as price
from customer_purchases
where vendor_id between 8 and 10;


select product_id,
       product_name,
	   case when product_qty_type = 'unit' then 'unit'
	   else 'bulk'
	   end as prod_qty_type_condensed,
	   case when lower(product_name) like '%pepper%'  then 1
	   else 0
	   end as pepper_flag
from product;


select *
from vendor t1
inner join vendor_booth_assignments t2
on t1.vendor_id and t2.vendor_id
order by vendor_name, market_date;

select vendor_id, count(*)
from vendor_booth_assignments 
group by vendor_id;

select customer_first_name,
       customer_last_name,
	   sum(t1.quantity*t1.cost_to_customer_per_qty) as spending
	   from customer_purchases t1 
	   inner join customer t2
	   on t1.customer_id = t2.customer_id
	   group by t1.customer_id
	   having sum(t1.quantity*t1.cost_to_customer_per_qty) &gt; 2000
	   order by 		customer_last_name, customer_first_name;
	   
select market_date,customer_first_name,
       customer_last_name,
	   sum(t1.quantity*t1.cost_to_customer_per_qty) as spending
	   from customer_purchases t1 
	   inner join customer t2
	   on t1.customer_id = t2.customer_id
	   group by t1.customer_id,market_date
	   --having sum(t1.quantity*t1.cost_to_customer_per_qty) &gt; 2000
	   order by 	market_date,customer_last_name, customer_first_name;

select customer_first_name,
       customer_last_name,
	   sum(t1.quantity*t1.cost_to_customer_per_qty) as spending
	   from customer_purchases t1 
	   inner join customer t2
	   on t1.customer_id = t2.customer_id
	   group by t1.customer_id
	   having sum(t1.quantity*t1.cost_to_customer_per_qty) &gt; 2000
	   order by customer_last_name, customer_first_name;
	   
-- 	   select market_date,
-- 	   customer_first_name,
--        customer_last_name,
-- 	   (t1.quantity*t1.cost_to_customer_per_qty) as spending
-- 	   from customer_purchases t1 
-- 	   inner join customer t2
-- 	   on t1.customer_id = t2.customer_id
-- 	   where market_date ='2022-04-05'
-- 	   group by t1.customer_id
-- 	   --having sum(t1.quantity*t1.cost_to_customer_per_qty) &gt; 2000
-- 	   order by 	market_date,customer_last_name, customer_first_name;

	   
	  DROP TABLE IF EXISTS new_vendor;
CREATE TEMP TABLE IF NOT EXISTS new_vendor AS 
select * from vendor;

INSERT INTO new_vendor
VALUES (10, 'Thomass Superfood Store', 'Fresh Focused', 'Thomas', 'Rosenthal');

select * from new_vendor;

select  customer_first_name,
			  customer_last_name,
			spending
from (select customer_first_name,customer_last_name,
		sum(t1.quantity*t1.cost_to_customer_per_qty) as spending,
        strftime('%m', market_date) as month,
		strftime('%Y',market_date) as year
		from customer_purchases t1
		inner join customer t2
		on t1.customer_id = t2.customer_id
		where month = '04' and year ='2022'
		group by t1.customer_id) as temp</sql><current_tab id="0"/></tab_sql></sqlb_project>
